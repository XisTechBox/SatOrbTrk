# 衛星トラッカー取扱説明書

## 1. このアプリでできること
手元の TLE（Two-Line Element）と自宅の緯度・経度・高度を入力すると、衛星の方位角・仰角・距離を 1 秒ごとに計算し、数値カードとポーラーチャートで表示します。ブラウザだけで動き、インターネット接続がなくても使用できます（ただし最新 TLE は別途取得してください）。

## 2. 事前準備
1. リポジトリを任意のフォルダに展開する。
2. 同ディレクトリに以下のファイルがあることを確認する：`index.html`、`styles.css`、`main.js`、`satellite.min.js`。
3. 最新の TLE（例: CelesTrak などからダウンロード）と観測地点の緯度・経度・高度（WGS84）を用意する。

## 3. 起動方法
1. ファイルマネージャーで `index.html` をダブルクリックするか、ブラウザの「ファイルを開く」で読み込む。  
   - ローカル HTTP サーバーは不要です。
2. ページが開いたら、フォームに観測地点と TLE を入力する。緯度・経度は小数で入力可能です。

## 4. 操作手順
1. **観測地点入力**  
   - 緯度 (°): 北緯は正、南緯は負。例 `33.572933`。  
   - 経度 (°): 東経は正、西経は負。例 `130.42122`。  
   - 高度 (m): 海抜高さをメートルで入力。
2. **TLE 入力**  
   - 1 行目と 2 行目をまとめて同じテキストエリアへ貼り付ける。衛星名の行が含まれていても自動で無視されます。
3. **トラッキング開始**  
   - 「トラッキング開始」を押すと 1 秒ごとに計算が走ります。途中で止めたい場合は「停止」を押してください。

## 5. 表示の見方
- **方位角**: 北を 0° として時計回り。例: 90° は東、180° は南。
- **仰角**: 0° は地平線、90° は天頂。負の値は地平線下で見えません。
- **距離**: 観測地点と衛星の直線距離 (km)。
- **ポーラーチャート**:  
  - 外周＝地平線、中心＝頭上。仰角が高いほど中心に近づきます。  
  - 北を上に配置。水色の点が現在位置、下部に数値ラベルが表示されます。  
  - 点描線は 30 秒ごとのサンプルで描画され、可視状態なら現在パスの残り、不可視時は次回パスの想定軌道を示します。
- **現在パス情報**:  
  - 仰角が 0° 以上の場合のみ表示され、AOS（仰角 0° を超えた瞬間の時刻＋方位角）、LOS（再び 0° を下回る瞬間の時刻＋方位角）、最大仰角（値＋到達時刻）を示します。  
  - LOS は最大 24 時間先まで探索し、見つからなければ「ー」と表示されます。
- **次の可視開始予測**:  
  - 現在が仰角 0° 未満の場合のみ表示され、次に地平線を超えるパスの AOS（時刻＋方位角）、LOS（時刻＋方位角）、および予測最大仰角を示します（最大 24 時間先まで探索）。
- **1 週間の可視パス**:  
  - トラッキング開始時にフォーム直下へリストが現れ、今後 7 日間で可視となる各パスの AOS/LOS/最大仰角を確認できます。

## 6. トラブルシューティング
| 症状 | 対処 |
| --- | --- |
| `TLE の解析でエラー (code: X)` | TLE にタイプミスがないか確認。2 行セットを丸ごと貼り付け直してください。 |
| すべて `N/A` のまま | 緯度・経度・高度が数値か確認。空欄があると計算されません。 |
| 値が更新しない | ブラウザタブがバックグラウンドにある間は自動停止します。再表示すると再開します。 |

## 7. よくある質問
- **Q. どの地球モデルで計算していますか？**  
  A. `satellite.min.js` を WGS84 定数に合わせて改造しているため、一般的な GPS 座標と整合します。
- **Q. ネットワーク接続は必要ですか？**  
  A. いいえ。すべてのスクリプトをローカルに同梱しているため、`index.html` を開くだけで動作します。
- **Q. 複数衛星を同時に見られますか？**  
  A. 現状は 1 つずつです。別の衛星を追跡する場合は TLE を入れ替えて再度開始してください。
